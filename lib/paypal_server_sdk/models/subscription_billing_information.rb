# paypal_server_sdk
#
# This file was automatically generated by APIMATIC v3.0
# ( https://www.apimatic.io ).

module PaypalServerSdk
  # The billing details for the subscription. If the subscription was or is
  # active, these fields are populated.
  class SubscriptionBillingInformation < BaseModel
    SKIP = Object.new
    private_constant :SKIP

    # The currency and amount for a financial transaction, such as a balance or
    # payment due.
    # @return [Money]
    attr_accessor :outstanding_balance

    # The trial and regular billing executions.
    # @return [Array[CycleExecution]]
    attr_accessor :cycle_executions

    # The details for the last payment.
    # @return [LastPaymentDetails]
    attr_accessor :last_payment

    # The date and time, in [Internet date and time
    # format](https://tools.ietf.org/html/rfc3339#section-5.6). Seconds are
    # required while fractional seconds are optional. Note: The regular
    # expression provides guidance but does not reject all invalid dates.
    # @return [String]
    attr_accessor :next_billing_time

    # The date and time, in [Internet date and time
    # format](https://tools.ietf.org/html/rfc3339#section-5.6). Seconds are
    # required while fractional seconds are optional. Note: The regular
    # expression provides guidance but does not reject all invalid dates.
    # @return [String]
    attr_accessor :final_payment_time

    # The number of consecutive payment failures. Resets to `0` after a
    # successful payment. If this reaches the `payment_failure_threshold` value,
    # the subscription updates to the `SUSPENDED` state.
    # @return [Integer]
    attr_accessor :failed_payments_count

    # The details for the failed payment of the subscription.
    # @return [FailedPaymentDetails]
    attr_accessor :last_failed_payment

    # A mapping from model property names to API property names.
    def self.names
      @_hash = {} if @_hash.nil?
      @_hash['outstanding_balance'] = 'outstanding_balance'
      @_hash['cycle_executions'] = 'cycle_executions'
      @_hash['last_payment'] = 'last_payment'
      @_hash['next_billing_time'] = 'next_billing_time'
      @_hash['final_payment_time'] = 'final_payment_time'
      @_hash['failed_payments_count'] = 'failed_payments_count'
      @_hash['last_failed_payment'] = 'last_failed_payment'
      @_hash
    end

    # An array for optional fields
    def self.optionals
      %w[
        cycle_executions
        last_payment
        next_billing_time
        final_payment_time
        last_failed_payment
      ]
    end

    # An array for nullable fields
    def self.nullables
      []
    end

    def initialize(outstanding_balance:, failed_payments_count:,
                   cycle_executions: SKIP, last_payment: SKIP,
                   next_billing_time: SKIP, final_payment_time: SKIP,
                   last_failed_payment: SKIP)
      @outstanding_balance = outstanding_balance
      @cycle_executions = cycle_executions unless cycle_executions == SKIP
      @last_payment = last_payment unless last_payment == SKIP
      @next_billing_time = next_billing_time unless next_billing_time == SKIP
      @final_payment_time = final_payment_time unless final_payment_time == SKIP
      @failed_payments_count = failed_payments_count
      @last_failed_payment = last_failed_payment unless last_failed_payment == SKIP
    end

    # Creates an instance of the object from a hash.
    def self.from_hash(hash)
      return nil unless hash

      # Extract variables from the hash.
      outstanding_balance = Money.from_hash(hash['outstanding_balance']) if
        hash['outstanding_balance']
      failed_payments_count =
        hash.key?('failed_payments_count') ? hash['failed_payments_count'] : nil
      # Parameter is an array, so we need to iterate through it
      cycle_executions = nil
      unless hash['cycle_executions'].nil?
        cycle_executions = []
        hash['cycle_executions'].each do |structure|
          cycle_executions << (CycleExecution.from_hash(structure) if structure)
        end
      end

      cycle_executions = SKIP unless hash.key?('cycle_executions')
      last_payment = LastPaymentDetails.from_hash(hash['last_payment']) if hash['last_payment']
      next_billing_time =
        hash.key?('next_billing_time') ? hash['next_billing_time'] : SKIP
      final_payment_time =
        hash.key?('final_payment_time') ? hash['final_payment_time'] : SKIP
      last_failed_payment = FailedPaymentDetails.from_hash(hash['last_failed_payment']) if
        hash['last_failed_payment']

      # Create object from extracted values.
      SubscriptionBillingInformation.new(outstanding_balance: outstanding_balance,
                                         failed_payments_count: failed_payments_count,
                                         cycle_executions: cycle_executions,
                                         last_payment: last_payment,
                                         next_billing_time: next_billing_time,
                                         final_payment_time: final_payment_time,
                                         last_failed_payment: last_failed_payment)
    end

    # Provides a human-readable string representation of the object.
    def to_s
      class_name = self.class.name.split('::').last
      "<#{class_name} outstanding_balance: #{@outstanding_balance}, cycle_executions:"\
      " #{@cycle_executions}, last_payment: #{@last_payment}, next_billing_time:"\
      " #{@next_billing_time}, final_payment_time: #{@final_payment_time}, failed_payments_count:"\
      " #{@failed_payments_count}, last_failed_payment: #{@last_failed_payment}>"
    end

    # Provides a debugging-friendly string with detailed object information.
    def inspect
      class_name = self.class.name.split('::').last
      "<#{class_name} outstanding_balance: #{@outstanding_balance.inspect}, cycle_executions:"\
      " #{@cycle_executions.inspect}, last_payment: #{@last_payment.inspect}, next_billing_time:"\
      " #{@next_billing_time.inspect}, final_payment_time: #{@final_payment_time.inspect},"\
      " failed_payments_count: #{@failed_payments_count.inspect}, last_failed_payment:"\
      " #{@last_failed_payment.inspect}>"
    end
  end
end
